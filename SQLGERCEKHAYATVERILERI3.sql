SELECT 	
	I.CATEGORY1 AS KATEGORI1,
	I.CATEGORY2 AS KATEGORI2,
	I.CATEGORY3,
	SUM(OD.LINETOTAL) AS SATIRTOPLAM,
	SUM(OD.AMOUNT) AS MIKTAR,
	COUNT(OD.ID) AS TOPLAMSIPARIS,
	SUM(OD.LINETOTAL) / SUM(OD.AMOUNT) AS ORTALAMA
FROM 
ORDERS O

JOIN USERS U ON U.ID=O.USERID
JOIN ADDRESS A ON A.USERID=U.ID
JOIN ORDERDETAILS OD ON OD.ORDERID=O.ID
JOIN ITEMS I ON I.ID = OD.ITEMID
WHERE I.CATEGORY1='KOZMETIK'

GROUP BY I.CATEGORY1,I.CATEGORY2,I.CATEGORY3
ORDER BY 4 DESC

















