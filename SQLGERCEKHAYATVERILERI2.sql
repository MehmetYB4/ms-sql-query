SELECT 
CT.CITY AS SEHIR,
SUM(OD.LINETOTAL) AS TOPLAMTUTAR,
SUM(OD.AMOUNT) AS SIPARISMIKTAR,
COUNT(OD.ID) AS SIPARISSAYISI

FROM ORDERS O
JOIN USERS U ON U.ID=O.USERID
JOIN ADDRESS A ON O.ADDRESSID=A.ID
JOIN CITIES CT ON CT.ID=A.CITYID
JOIN ORDERDETAILS OD ON OD.ORDERID=O.ID
GROUP BY CT.CITY
ORDER BY SUM(OD.LINETOTAL) DESC --2























